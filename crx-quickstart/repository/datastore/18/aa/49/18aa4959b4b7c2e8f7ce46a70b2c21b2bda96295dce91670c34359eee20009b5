/*!************************************************************************
*
* ADOBE CONFIDENTIAL
* ___________________
*
*  Copyright 2018 Adobe Systems Incorporated
*  All Rights Reserved.
*
* NOTICE:  All information contained herein is, and remains
* the property of Adobe Systems Incorporated and its suppliers,
* if any.  The intellectual and technical concepts contained
* herein are proprietary to Adobe Systems Incorporated and its
* suppliers and are protected by trade secret or copyright law.
* Dissemination of this information or reproduction of this material
* is strictly forbidden unless prior written permission is obtained
* from Adobe Systems Incorporated.
**************************************************************************/
(function(a){a.pkg("s7sdk.video");if(!a.video.BaseVideoProxy){a.video.BaseVideoProxy=function c(l,p,d,q,f,e,j,k,g,o,m,n,h){this.serverUrl=d;this.aemmode=n;this.videoServerUrl=q;this.curTime=0;this.bufTime=0;this.serverDuration=0;this.videoDuration=0;this.fallbackmessage=m;this.volume=1;this.mutedValue=o;this.playback=e;this.progressivebitrate=j*1024;this.width=l;this.height=p;this.callQueue=[];this.proxyIsReady=false;this.loop=k;this.preload=g;this.autoPlay=f;this.isDisposed=false;this.firstAsset=true;this.videoElement=null;this.videoWidth=0;this.videoHeight=0;this.useCORS=h;this.createVideoElement()};a.video.BaseVideoProxy.prototype.getDurationFromItem=function(e){if(e.type==a.ItemDescType.VIDEO_SET){var d=e.items[0];if(d.userData&&d.userData.Video_Length){return parseFloat(d.userData.Video_Length)*1000}else{if((d.userData instanceof Array)&&d.userData[0].Video_Length){return parseFloat(d.userData[0].Video_Length)*1000}}}else{if(e.userData&&e.userData.Video_Length){return parseFloat(e.userData.Video_Length)*1000}else{if((e.userData instanceof Array)&&e.userData[0].Video_Length){return parseFloat(e.userData[0].Video_Length)*1000}}}return undefined};a.video.BaseVideoProxy.prototype.getVideoElement=function(){return this.videoElement};a.video.BaseVideoProxy.prototype.createVideoElement=function(){if(this.videoElement){this.curTime=0;this.bufTime=0;this.serverDuration=0;this.videoDuration=0;this.videoElement=null}this.videoElement=a.Util.createObj(null,"video",null,null);this.videoElement.setAttribute("tabindex",-1);if(this.useCORS){this.videoElement.setAttribute("crossOrigin","anonymous")}if(this.mutedValue){this.videoElement.setAttribute("muted","")}this.videoElement.volume=this.volume;this.videoElement.muted=this.mutedValue;this.videoElement.style.position="absolute";this.resize(this.width,this.height);this.videoElement.preload=this.preload?"auto":"none";if(this.autoPlay){this.videoElement.autoplay=true}if(this.playback.controls){this.videoElement.controls=true}else{if(("ipad"==a.browser.device.name)||(("blackberry"==a.browser.device.name)&&(a.browser.device.version==10))){this.videoElement.setAttribute("webkit-playsinline",1)}}if(this.loop){this.videoElement.loop=true}this.addVideoElementEventListeners()};a.video.BaseVideoProxy.prototype.addVideoElementEventListeners=function(){var d=this;a.Event.addDOMListener(this.videoElement,"timeupdate",function(){if(d.isDisposed){return}if(a.browser.name=="ie"){d.isbuffering=false;d.onBuffering(false)}var e=d.curTime;d.curTime=d.videoElement.currentTime;if(d.videoElement.ended&&(d.videoDuration!=d.curTime)){d.curTime=d.videoDuration}if(e!=d.curTime){d.onCurrentTime()}},{capture:true});a.Event.addDOMListener(this.videoElement,"loadstart",function(){if(d.isDisposed){return}d.onLoadProgress()},{capture:true});a.Event.addDOMListener(this.videoElement,"canplay",function(){if(d.isDisposed){return}d.isbuffering=false;d.onBuffering(false)},{capture:true});a.Event.addDOMListener(this.videoElement,"waiting",function(){if(d.isDisposed){return}d.isbuffering=true;d.onBuffering(true)},{capture:true});a.Event.addDOMListener(this.videoElement,"loadedmetadata",function(){if(d.isDisposed){return}var e=false;if(!d.videoWidth&&!d.videoHeight){e=true;d.videoWidth=this.videoWidth;d.videoHeight=this.videoHeight;d.resize(d.getWidth(),d.getHeight())}d.proxyIsReady=true;while(d.callQueue.length>0){var f=d.callQueue[0];d.callQueue.splice(0,1);d[f.func].apply(d,f.args)}d.onLoadProgress();if(e){d.onVideoDimension()}},{capture:true});a.Event.addDOMListener(this.videoElement,"progress",function(){if(d.isDisposed){return}d.onLoadProgress()},{capture:true});a.Event.addDOMListener(this.videoElement,"durationchange",function(){if(d.isDisposed){return}var e=d.videoElement.duration;if(("android"==a.browser.device.name)&&(4==a.browser.device.version)&&(d.videoElement.readyState<4)){return}if((a.browser.name=="safari")&&(d.serverDuration)&&((e==Math.floor(d.serverDuration))||(e==Math.ceil(d.serverDuration)))){e=d.serverDuration}if(e!=d.videoDuration){d.videoDuration=e;d.onDuration()}},{capture:true});a.Event.addDOMListener(this.videoElement,"volumechange",function(){if(d.isDisposed){return}d.onVolume()},{capture:true});a.Event.addDOMListener(this.videoElement,"seeked",function(){if(d.isDisposed){return}if(a.browser.name=="ie"){d.isbuffering=false;d.onBuffering(false)}d.onSeeked()},{capture:true});a.Event.addDOMListener(this.videoElement,"play",function(){if(d.isDisposed){return}d.onStateChange()},{capture:true});a.Event.addDOMListener(this.videoElement,"pause",function(){if(d.isDisposed){return}d.onStateChange()},{capture:true});a.Event.addDOMListener(this.videoElement,"ended",function(){if(d.isDisposed){return}if(d.videoDuration!=d.curTime){d.curTime=d.videoDuration}d.onCurrentTime();d.onStateChange()},{capture:true});a.Event.addDOMListener(this.videoElement,"loadeddata",function(){if(d.isDisposed){return}d.onViewReady()},{capture:true})};a.video.BaseVideoProxy.prototype.getVolume=function(){return this.videoElement.volume};a.video.BaseVideoProxy.prototype.setVolume=function(d){if(this.videoElement.muted){this.mutedValue=this.videoElement.muted=false}this.volume=d;this.videoElement.volume=d};a.video.BaseVideoProxy.prototype.mute=function(d){this.mutedValue=this.videoElement.muted=d};a.video.BaseVideoProxy.prototype.muted=function(){return this.videoElement.muted};a.video.BaseVideoProxy.prototype.getLoadedPosition=function(){return((this.videoElement.buffered&&this.videoElement.buffered.length>0)?this.videoElement.buffered.end(0)*1000:0)};a.video.BaseVideoProxy.prototype.getDuration=function(){if(a.Util.isNull(this.videoDuration)){return undefined}else{return this.videoDuration*1000}};a.video.BaseVideoProxy.prototype.getVideoWidth=function(){return this.videoWidth};a.video.BaseVideoProxy.prototype.getVideoHeight=function(){return this.videoHeight};a.video.BaseVideoProxy.prototype.ended=function(){return this.videoElement.ended};a.video.BaseVideoProxy.prototype.getWidth=function(){return this.width};a.video.BaseVideoProxy.prototype.getHeight=function(){return this.height};a.video.BaseVideoProxy.prototype.play=function(){this.videoElement.play()};a.video.BaseVideoProxy.prototype.paused=function(){return this.videoElement.paused};a.video.BaseVideoProxy.prototype.pause=function(){if(this.isbuffering){this.isbuffering=false;this.onBuffering(false)}this.videoElement.pause()};a.video.BaseVideoProxy.prototype.getCurrentTime=function(){return this.curTime*1000};a.video.BaseVideoProxy.prototype.dispose=function(){if(this.videoElement){this.videoElement.pause();this.videoElement.removeAttribute("src");this.videoElement.load();if(this.videoElement.parentElement){this.videoElement.parentElement.removeChild(this.videoElement)}}this.isDisposed=true};a.video.BaseVideoProxy.prototype.resize=function(e,f){var d,g;this.width=e;this.height=f;if(this.videoHeight&&this.videoWidth){d=e*this.videoHeight/this.videoWidth;if(d>f){g=this.videoWidth*f/this.videoHeight;d=f}else{g=e}}else{d=f;g=e}this.videoElement.width=g*a.browser.device.pixelratio;this.videoElement.height=d*a.browser.device.pixelratio;this.videoElement.style.width=g+"px";this.videoElement.style.height=d+"px";this.videoElement.style.left=(e-g)/2+"px";this.videoElement.style.top=(f-d)/2+"px"};a.video.BaseVideoProxy.prototype.seek=function(e){if(!this.proxyIsReady){this.fillMethodQueue("seek",[e]);return}var d=(!this.videoElement.paused);this.videoElement.currentTime=e/1000;this.curTime=e/1000;if((a.browser.device.name=="ipad")&&(a.browser.device.version==6)&&e==0){if(d){this.videoElement.play()}}};a.video.BaseVideoProxy.prototype.setVideoDimensionFromItem=function(d){if(d.items){this.videoWidth=d.items[0].width;this.videoHeight=d.items[0].height}else{if(d.width){this.videoWidth=d.width;this.videoHeight=d.height}}};a.video.BaseVideoProxy.prototype.onLoadProgress=function(){};a.video.BaseVideoProxy.prototype.onCurrentTime=function(){};a.video.BaseVideoProxy.prototype.onDuration=function(){};a.video.BaseVideoProxy.prototype.onVideoDimension=function(){};a.video.BaseVideoProxy.prototype.onSeeked=function(){};a.video.BaseVideoProxy.prototype.onVolume=function(){};a.video.BaseVideoProxy.prototype.onStateChange=function(){};a.video.BaseVideoProxy.prototype.onViewReady=function(){};a.video.BaseVideoProxy.prototype.resolvePosterUrl=function(k,f,l,m,g){var e=(k!=undefined)?k:f;var d="";if(e==""||e.indexOf("?")==0){d=e;if(l){e=m.name}else{if(m.hasOwnProperty("image")&&m.image){e=this.parseMovieUrl(m.image.name)}else{e=this.parseMovieUrl(m.name)}}}var o=null;if(e!=null&&e!=""&&e!="none"){var h=(e.indexOf("?")>=0)?"&":"?";if(d!=""){if(d.indexOf("?")==0){h=d}else{h+=d}h+="&"}if(g){var n=null;if(m.type==a.ItemDescType.VIDEO_SET){n=m.items[0];for(var j=0;j<m.items.length;j++){if(m.items[j].height>=n.height){n=m.items[j]}}}else{n=m}h+="fit=constrain,1&wid="+n.width+"&hei="+n.height}else{h+="fit=constrain,1&wid="+this.width+"&hei="+this.height}o=e+h}return o};a.video.BaseVideoProxy.prototype.parseMovieUrl=function(f){var d=null;if(f){d=f.replace(/[\\]/g,"/");var e=d.split(/\.(mp4|f4v|flv|webm)/i);if(e.length>1){d=e[0]}e=d.split(":");if(e.length>1){d=e[1]}e=d.split("/");d=e.length>1?e[0]+"/"+e[e.length-1]:d}return d};a.video.BaseVideoProxy.prototype.fillMethodQueue=function(e,d){this.callQueue.push({func:e,args:d})};a.video.BaseVideoProxy.prototype.getOrigin=function(d){var e=window.document.createElement("a");e.href=d;return e.protocol+e.hostname+e.port};a.video.BaseVideoProxy.prototype.fixSafariCrossOrigin=function(d){if(this.videoElement&&this.useCORS){this.videoElement.removeAttribute("crossOrigin");if((this.getOrigin(d)!=this.getOrigin(window.location.href))||this.playback!="progressive"){this.videoElement.setAttribute("crossOrigin","anonymous")}}}}if(!a.video.HTML5VideoProxy){a.video.HTML5VideoProxy=function HTML5VideoProxy(l,o,d,q,f,e,j,k,g,p,m,n,h){a.Logger.log(a.Logger.INFO,"HTML5VideoProxy constructor");arguments.callee.superclass.apply(this,[l,o,d,q,f,e,j,k,g,p,m,n,h])};a.Class.inherits("s7sdk.video.HTML5VideoProxy","s7sdk.video.BaseVideoProxy");a.video.HTML5VideoProxy.prototype.setVideo=function(e,d){this.callQueue.splice(0,this.callQueue.length);this.proxyIsReady=false;var j;this.firstAsset=false;var h=this;if(d!=null){this.videoElement.poster=d;var g=new Image();a.Event.addDOMListener(g,"load",function(){h.onViewReady()},{capture:true});g.src=d}while(this.videoElement.firstChild){this.videoElement.removeChild(this.videoElement.firstChild)}this.videoElement.load();var f=document.createElement("p");f.innerText=this.fallbackmessage;this.videoElement.appendChild(f);if(a.browser.name=="safari"){this.fixSafariCrossOrigin(e)}var k=document.createElement("source");k.src=e;this.videoElement.appendChild(k);if(a.browser.name=="safari"){k.setAttribute("type","video/mp4")}this.resize(this.width,this.height)};a.video.HTML5VideoProxy.prototype.setAsset=function(e,d){this.callQueue.splice(0,this.callQueue.length);this.proxyIsReady=false;this.serverDuration=this.getDurationFromItem(e)/1000;if(this.serverDuration){this.videoDuration=this.serverDuration}var l=a.MediaSetParser.resolveVideoAsset(e,this.playback,this.progressivebitrate,this.aemmode,this.videoServerUrl);this.setVideoDimensionFromItem(e);this.firstAsset=false;var j=this;if(d!=null){this.videoElement.poster=a.Util.resolveURL(this.serverUrl,d);var h=new Image();a.Event.addDOMListener(h,"load",function(){j.onViewReady()},{capture:true});h.src=a.Util.resolveURL(this.serverUrl,d)}var g;if(a.Util.isArray(l)){g=[];for(i=0;i<l.length;i++){g[i]=a.Util.resolveURL(this.videoServerUrl,l[i])}}else{g=a.Util.resolveURL(this.videoServerUrl,l)}while(this.videoElement.firstChild){this.videoElement.removeChild(this.videoElement.firstChild)}var f=document.createElement("p");f.innerText=this.fallbackmessage;this.videoElement.appendChild(f);if(a.browser.name=="safari"){this.fixSafariCrossOrigin(this.videoServerUrl)}var k;if(a.Util.isArray(g)){for(i=0;i<g.length;i++){k=document.createElement("source");k.src=g[i];this.videoElement.appendChild(k)}}else{k=document.createElement("source");k.src=g;this.videoElement.appendChild(k)}if(a.browser.name=="safari"){k.setAttribute("type","video/mp4")}this.resize(this.width,this.height);this.onVideoDimension()};a.video.HTML5VideoProxy.prototype.setHLSLevel=function(d){}}if(!a.video.IPhoneProxy){a.video.IPhoneProxy=function IPhoneProxy(p,l,o,d,r,f,e,k,j,g,q,m,n,h){a.Logger.log(a.Logger.INFO,"IPhoneProxy constructor");arguments.callee.superclass.apply(this,[l,o,d,r,f,e,k,j,g,q,m,n,h]);this.container=p;this.createPosterElement(l,o)};a.Class.inherits("s7sdk.video.IPhoneProxy","s7sdk.video.BaseVideoProxy");a.video.IPhoneProxy.prototype.createVideoElement=function(){if(this.videoElement){this.curTime=0;this.bufTime=0;this.serverDuration=0;this.videoDuration=0;this.videoElement=null}this.videoElement=a.Util.createObj(null,"video",null,null);this.videoElement.preload=this.preload?"auto":"none";this.videoElement.setAttribute("tabindex",-1);if(this.playback.controls){this.videoElement.controls=true}if(this.useCORS){this.videoElement.setAttribute("crossOrigin","anonymous")}if(this.mutedValue){this.videoElement.setAttribute("muted","")}if(this.autoPlay){this.videoElement.autoplay=true}this.videoElement.muted=this.mutedValue;this.videoElement.style.position="absolute";this.isCanPlaysInline=a.browser.device.version>=10;if(this.isCanPlaysInline){this.videoElement.setAttribute("playsinline",1)}else{this.videoElement.style.width="1px";this.videoElement.style.height="1px"}var d=document.createElement("p");d.innerText=this.fallbackmessage;this.videoElement.appendChild(d);if(this.loop){this.videoElement.loop=true}this.addVideoElementEventListeners()};a.video.IPhoneProxy.prototype.createPosterElement=function(d,e){if(!this.isCanPlaysInline){if(this.divPosterElement&&(this.divPosterElement.parentElement!=null)){this.divPosterElement.parentElement.removeChild(this.divPosterElement)}this.divPosterElement=a.Util.createObj(null,"div",null,null);this.divPosterElement.className="s7videoposter";this.divPosterElement.style.width=d+"px";this.divPosterElement.style.height=e+"px"}};a.video.IPhoneProxy.prototype.setAsset=function(f,d){var j=a.MediaSetParser.resolveVideoAsset(f,this.playback,this.progressivebitrate,this.aemmode,this.videoServerUrl);this.setVideoDimensionFromItem(f);this.serverDuration=this.getDurationFromItem(f)/1000;if(this.serverDuration){this.videoDuration=this.serverDuration}if(!this.firstAsset){this.createPosterElement(this.width,this.height)}this.firstAsset=false;var e=this;a.Event.addDOMListener(this.videoElement,"webkitendfullscreen",function(k){e.onStateChange()});if(d!=null&&this.divPosterElement){this.divPosterElement.style.backgroundImage="url('"+a.Util.resolveURL(this.serverUrl,d)+"')";this.videoElement.parentElement.insertBefore(this.divPosterElement,this.videoElement)}var g;if(a.Util.isArray(j)){g=[];for(i=0;i<j.length;i++){g[i]=a.Util.resolveURL(this.videoServerUrl,j[i])}}else{g=a.Util.resolveURL(this.videoServerUrl,j)}while(this.videoElement.firstChild){this.videoElement.removeChild(this.videoElement.firstChild)}if(a.browser.name=="safari"){this.fixSafariCrossOrigin(this.videoServerUrl)}var h;if(a.Util.isArray(g)){for(i=0;i<g.length;i++){h=document.createElement("source");h.src=g[i];this.videoElement.appendChild(h)}}else{h=document.createElement("source");h.src=g;this.videoElement.appendChild(h)}if(a.browser.name=="safari"){h.setAttribute("type","video/mp4")}if(d!=null&&!this.divPosterElement){this.videoElement.poster=a.Util.resolveURL(this.serverUrl,d)}this.resize(this.width,this.height);if(this.preload){this.videoElement.load()}this.onVideoDimension()};a.video.IPhoneProxy.prototype.setVideo=function(g,d){if(!this.firstAsset){this.createPosterElement(this.width,this.height)}this.firstAsset=false;var e=this;a.Event.addDOMListener(this.videoElement,"webkitendfullscreen",function(h){e.onStateChange()});if(this.divPosterElement){this.divPosterElement.style.backgroundImage=d?"url('"+d+"')":"none";this.videoElement.parentElement.insertBefore(this.divPosterElement,this.videoElement)}while(this.videoElement.firstChild){this.videoElement.removeChild(this.videoElement.firstChild)}if(a.browser.name=="safari"){this.fixSafariCrossOrigin(g)}var f=document.createElement("source");f.src=g;this.videoElement.appendChild(f);if(a.browser.name=="safari"){f.setAttribute("type","video/mp4")}if(!this.divPosterElement){this.videoElement.poster=d?d:""}this.resize(this.width,this.height);if(this.preload){this.videoElement.load()}};a.video.IPhoneProxy.prototype.getVolume=function(){return 1};a.video.IPhoneProxy.prototype.setVolume=function(d){};a.video.IPhoneProxy.prototype.mute=function(d){};a.video.IPhoneProxy.prototype.setHLSLevel=function(d){};a.video.IPhoneProxy.prototype.resize=function(e,f){this.width=e;this.height=f;if(this.isCanPlaysInline){var d,g;this.width=e;this.height=f;if(this.videoHeight&&this.videoWidth){d=e*this.videoHeight/this.videoWidth;if(d>f){g=this.videoWidth*f/this.videoHeight;d=f}else{g=e}}else{d=f;g=e}this.videoElement.width=g*a.browser.device.pixelratio;this.videoElement.height=d*a.browser.device.pixelratio;this.videoElement.style.width=g+"px";this.videoElement.style.height=d+"px";this.videoElement.style.left=(e-g)/2+"px";this.videoElement.style.top=(f-d)/2+"px"}if(this.divPosterElement){this.divPosterElement.style.width=e+"px";this.divPosterElement.style.height=f+"px"}};a.video.IPhoneProxy.prototype.seek=function(d){this.videoElement.currentTime=d/1000};a.video.IPhoneProxy.prototype.dispose=function(){if(this.divPosterElement&&(this.divPosterElement.parentElement!=null)){this.divPosterElement.parentElement.removeChild(this.divPosterElement);this.divPosterElement=null}this.superclass.prototype.dispose.apply(this)}}if(!a.video.HLSVideoProxy){a.video.HLSVideoProxy=function HLSVideoProxy(n,q,d,s,f,e,k,m,j,g,r,o,p,h){a.Util.require("s7sdk.libs.hls.hls");arguments.callee.superclass.apply(this,[n,q,d,s,f,e,k,j,g,r,o,p,h]);a.Logger.log(a.Logger.INFO,"HLSVideoProxy constructor");this.hlsPlayer=null;this.mediaResource=null;this.videoView=null;this.initialbitrate=m*1024;var l=this;this.loadHlsJsAndCreatePlayer=function(){if(a.Hls){l.createHLSPlayer();clearTimeout(l.hlsjsLoadTimer);l.hlsjsLoadTimer=null}else{if(l.hlsjsLoadTimer){clearTimeout(l.hlsjsLoadTimer);l.hlsjsLoadTimer=null}l.hlsjsLoadTimer=setTimeout(l.loadHlsJsAndCreatePlayer,100)}};this.loadHlsJsAndCreatePlayer()};a.Class.inherits("s7sdk.video.HLSVideoProxy","s7sdk.video.BaseVideoProxy");a.video.HLSVideoProxy.prototype.createHLSPlayer=function(f){if(this.hlsPlayer){this.curTime=0;this.bufTime=0;this.serverDuration=0;this.videoDuration=0;this.hlsPlayer.destroy();if(this.hlsPlayer.bufferTimer){clearInterval(this.hlsPlayer.bufferTimer);this.hlsPlayer.bufferTimer=undefined}this.hlsPlayer=null;delete this.hlsPlayer}var d={fragLoadingTimeOut:60000,maxBufferSize:30*1000*1000};if(a.Hls){this.hlsPlayer=new a.Hls(d);this.hlsPlayer.on(a.Hls.Events.MEDIA_ATTACHED,function(){a.Logger.log(a.Logger.FINE,"HLSVideoProxy: Hls.Events.MEDIA_ATTACHED - Media attached !")});this.hlsPlayer.on(a.Hls.Events.MANIFEST_LOADING,function(g,h){a.Logger.log(a.Logger.FINE,"HLSVideoProxy: Hls.Events.MANIFEST_LOADING Manifest=%0",h.url)});this.hlsPlayer.on(a.Hls.Events.MANIFEST_LOADED,function(g,h){a.Logger.log(a.Logger.FINE,"HLSVideoProxy: Hls.Events.MANIFEST_LOADED Manifest data levels=%0",h.levels.length)});this.hlsPlayer.on(a.Hls.Events.MANIFEST_PARSED,function(h,j){a.Logger.log(a.Logger.FINE,"HLSVideoProxy: Hls.Events.MANIFEST_PARSED Found %0 quality levels",j.levels.length);for(var g=0;g<j.levels.length;g++){a.Logger.log(a.Logger.FINE,"HLSVideoProxy: * %0 quality level  bitrate=%1",g,j.levels[g].bitrate)}});this.hlsPlayer.on(a.Hls.Events.LEVEL_SWITCH,function(g,h){a.Logger.log(a.Logger.FINE,"HLSVideoProxy: Hls.Events.LEVEL_SWITCH Level switched! Current level =%0",h.level)});this.hlsPlayer.on(a.Hls.Events.FRAG_CHANGED,function(g,h){a.Logger.log(a.Logger.FINE,"HLSVideoProxy: Hls.Events.FRAG_CHANGED Fragment changed! Current fragment number =%0; fragment's level =%1; fragment's url =%2",h.frag.sn,h.frag.level,h.frag.url)});this.hlsPlayer.on(a.Hls.Events.FRAG_LOADING,function(g,h){a.Logger.log(a.Logger.FINE,"HLSVideoProxy: Hls.Events.FRAG_LOADING Fragment loading! Current fragment number =%0; fragment's level =%1; fragment's url =%2",h.frag.sn,h.frag.level,h.frag.url)});this.hlsPlayer.on(a.Hls.Events.FRAG_LOADED,function(g,h){a.Logger.log(a.Logger.FINE,"HLSVideoProxy: Hls.Events.FRAG_LOADED Fragment loaded! Current fragment number =%0; fragment's level =%1; fragment's url =%2; length=%3",h.frag.sn,h.frag.level,h.frag.url,h.stats.length)});this.hlsPlayer.on(a.Hls.Events.FRAG_PARSING_METADATA,function(g,h){a.Logger.log(a.Logger.FINE,"HLSVideoProxy: Hls.Events.FRAG_PARSING_METADATA Parsing id3 is completed! Demuxer id =%0",h.id)});this.hlsPlayer.on(a.Hls.Events.FRAG_PARSING_DATA,function(g,h){a.Logger.log(a.Logger.FINE,"HLSVideoProxy: Hls.Events.FRAG_PARSING_DATA Parsing id3 is completed! Number of samples =%0; type  =%1;  PTS of first sample =%2; PTS of last sample =%2; DTS of first sample =%4; DTS of last sample =%5",h.nb,h.type,h.startPTS,h.endPTS,h.startDTS,h.endDTS)})}while(this.callQueue.length>0){var e=this.callQueue[0];this.callQueue.splice(0,1);this[e.func].apply(this,e.args)}};a.video.HLSVideoProxy.prototype.setVideo=function(e,d){this.callQueue.splice(0,this.callQueue.length);this.proxyIsReady=false;var h;this.firstAsset=false;this.createHLSPlayer();var g=this;if(d!=null){this.videoElement.poster=d;var f=new Image();a.Event.addDOMListener(f,"load",function(){g.onViewReady()},{capture:true});f.src=d}if(this.hlsPlayer){this.hlsPlayer.startLevel=b(e,this.initialbitrate);if(this.preload||this.autoPlay){this.hlsPlayer.loadSource(e);this.preloaded=true}else{this.preloaded=false;this.item=e}this.hlsPlayer.attachMedia(this.videoElement)}else{this.fillMethodQueue("setVideo",[e,d])}this.resize(this.width,this.height)};a.video.HLSVideoProxy.prototype.play=function(){if(!this.preloaded){this.preloaded=true;this.hlsPlayer.loadSource(this.item)}this.videoElement.play()};function b(g,f){if(g!=null&&g.items){var l=g.items;if(typeof(l.filter)!="undefined"){l=l.filter(function(n,o,m){return m.map(function(p){return p["bitrate"]}).indexOf(n["bitrate"])===o})}if(l.length>1){l.sort(function(n,m){return n.bitrate-m.bitrate});var k=0;var j=false;for(var d=l.length-1;d>0;d--){var e=l[d];if(e.bitrate<=f){k=d;j=true;break}}var h=j?k:0;return h}else{return 0}}else{return -1}}a.video.HLSVideoProxy.prototype.setAsset=function(e,d){this.callQueue.splice(0,this.callQueue.length);this.proxyIsReady=false;if(!this.videoElement){this.createVideoElement()}this.firstAsset=false;this.createHLSPlayer();var j=a.MediaSetParser.resolveVideoAsset(e,this.playback,this.progressivebitrate,this.aemmode,this.videoServerUrl);this.setVideoDimensionFromItem(e);var h=a.Util.resolveURL(this.videoServerUrl,j);if(this.hlsPlayer){this.hlsPlayer.startLevel=b(e,this.initialbitrate);this.hlsPlayer.streamController.fragBitrateTest=true;if(this.preload||this.autoPlay){this.hlsPlayer.loadSource(h);this.preloaded=true}else{this.preloaded=false;this.item=h}this.hlsPlayer.attachMedia(this.videoElement)}else{this.fillMethodQueue("setAsset",[e,d])}var g=this;if(d!=null){this.videoElement.poster=a.Util.resolveURL(this.serverUrl,d);var f=new Image();a.Event.addDOMListener(f,"load",function(){g.onViewReady()},{capture:true});f.src=a.Util.resolveURL(this.serverUrl,d)}this.resize(this.width,this.height);this.onVideoDimension()};a.video.HLSVideoProxy.prototype.dispose=function(){if(this.hlsjsLoadTimer){clearTimeout(this.hlsjsLoadTimer);this.hlsjsLoadTimer=null}if(this.hlsPlayer){this.hlsPlayer.destroy();if(this.hlsPlayer.bufferTimer){clearInterval(this.hlsPlayer.bufferTimer);this.hlsPlayer.bufferTimer=undefined}}this.superclass.prototype.dispose.apply(this)};a.video.HLSVideoProxy.prototype.setHLSLevel=function(d){if(this.hlsPlayer){this.hlsPlayer.loadLevel=d}}}})(s7getCurrentNameSpace());